% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gate_cells.R
\name{gate_cells}
\alias{gate_cells}
\title{Gate Cells Using Predefined Gating Sets}
\usage{
gate_cells(
  flowset,
  gatingset,
  gatename = "/Singlets/CD45+/CD3+",
  verbose = TRUE,
  inplace = FALSE
)
}
\arguments{
\item{flowset}{A \code{flowSet} or list of \code{flowFrame} objects representing compensated samples.
These FCS files are expected to contain the compensation matrix, but not have compensation applied.}

\item{gatingset}{A named list of \code{GatingSet} objects, one per sample, or a single global \code{GatingSet}.}

\item{gatename}{Character or numeric. Name or index of the population to extract.
Default is \code{"/Singlets/CD45+/CD3+"}. If numeric, the nth gate will be selected.}

\item{verbose}{Logical. Print progress information? Default: \code{TRUE}.}

\item{inplace}{Logical. If \code{TRUE}, modifies the \code{flowset} in place. Otherwise, a new \code{flowSet} is created.}
}
\value{
A list with two elements:
\describe{
\item{\code{counts}}{A \code{data.table} of per-population counts, frequencies, and MFIs across all samples.}
\item{\code{flowset_gated}}{The updated \code{flowSet}, with each sample replaced by its gated \code{flowFrame}.}
}
}
\description{
This function applies existing \code{GatingSet} objects to a \code{flowSet} (usually of compensated FCS files),
extracts gated populations (e.g., CD3+ cells), and optionally computes population statistics
such as counts, frequencies, and median fluorescence intensities (MFIs).
}
\details{
\itemize{
\item Assumes FCS filenames and gating set names match by sample ID (\code{sampleNames()}).
\item If only one gating set is given, it is applied to all samples (useful for batch gating).
\item Compensation is NOT applied again, assuming it's already been handled.
\item All columns are temporarily treated as marker names to enable MFI extraction across the full feature set.
}
}
\keyword{cytometry}
