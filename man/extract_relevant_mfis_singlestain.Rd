% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_mfi.R
\name{extract_relevant_mfis_singlestain}
\alias{extract_relevant_mfis_singlestain}
\title{Extract MFIs from Single-Stain Cytometry Samples}
\usage{
extract_relevant_mfis_singlestain(
  loaded_fcs_singlestain,
  transform_fun = function(x) {
     x
 },
  seed = 42
)
}
\arguments{
\item{loaded_fcs_singlestain}{A named list of cytosets or cytoframes containing single-stain FCS data.
Each element should contain a single sample with one non-empty marker channel, or none (for unstained).
The channels must have "empty" as their description if not filled.}

\item{transform_fun}{Function applied to the data before clustering.
Default: \code{function(x) asinh(x / 1e3)}. Does not affect reported MFIs, only through the clustering.}

\item{seed}{Integer random seed for reproducible k-means clustering. Default is \code{42}.}
}
\value{
A named list of \code{tibble}s, one per input file, each with columns:
\describe{
\item{\code{feature}}{The marker channel name (e.g., \code{"FITC-A"}).}
\item{\code{negative}, \code{positive}}{MFI values per cluster, if applicable.}
\item{\code{unstained}}{Median intensity if the sample is unstained (no non-empty channels).}
}
}
\description{
This function extracts the median fluorescence intensity (MFI) for each single-stain sample
using seeded k-means clustering (k=2) to separate positive and negative populations. It also identifies
unstained samples (i.e., samples with no non-empty channels) and records their median values.
}
\examples{
set.seed(42)
fs_ss <- simulate_cd3()
tmpdir <- local_tempdir_time()
flowCore::write.flowSet(fs_ss, tmpdir)
loaded_fcs <- load_mfi_files(
    fcs_dir = tmpdir,
    regex_singlestain = "(-(CD3-.*)|(none))\\\\.fcs$",
    gating_set_file = NULL,
    gate_extract = NULL
)
extract_singlestain_mfi_wrapper(loaded_fcs)
extract_relevant_mfis_singlestain(loaded_fcs)
}
\keyword{relativisation}
