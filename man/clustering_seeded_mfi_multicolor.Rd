% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_mfi.R
\name{clustering_seeded_mfi_multicolor}
\alias{clustering_seeded_mfi_multicolor}
\title{Clustered MFI Extraction for Multiple Marker Channels}
\usage{
clustering_seeded_mfi_multicolor(
  values,
  seed = 42,
  transform_fun = function(x) {
     x
 }
)
}
\arguments{
\item{values}{A numeric matrix or data.frame of untransformed expression values.
Columns represent marker channels; rows are cells.}

\item{seed}{Integer. Random seed to ensure reproducibility. Default is \code{42}.}

\item{transform_fun}{Function. Transformation to apply prior to clustering
(e.g., \code{asinh(x / 1e3)}).}
}
\value{
A \code{tibble} with columns:
\describe{
\item{\code{feature}}{Channel name (from \code{colnames(values)})}
\item{\code{negative}, \code{positive}}{Clustered median intensities (original scale)}
\item{\code{negative.sd}, \code{positive.sd}}{Standard deviations within clusters}
\item{\code{negative.iqr}, \code{positive.iqr}}{Interquartile ranges within clusters}
}
}
\description{
This function performs seeded k-means clustering (k = 2) on transformed multi-channel
fluorescence values to separate negative and positive cell populations. It computes
median, standard deviation, and interquartile range (IQR) of the untransformed
values for each marker, returning a tidy \code{tibble} with one row per marker.
}
\details{
The cluster with the lower total median signal across all markers is considered
the negative population.
}
\examples{
\dontrun{
df <- data.frame(
    marker1 = rnorm(100, mean = 100, sd = 20),
    marker2 = rnorm(100, mean = 200, sd = 30)
)
clustering_seeded_mfi_multicolor(df)
clustering_seeded_mfi_multicolor(df, seed = 123, transform_fun = function(x) asinh(x / 1e3))
}
}
\keyword{relativisation}
