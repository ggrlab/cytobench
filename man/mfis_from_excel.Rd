% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mfis_from_excel.R
\name{mfis_from_excel}
\alias{mfis_from_excel}
\title{Extract Median Fluorescence Intensities (MFIs) from Excel File}
\usage{
mfis_from_excel(
  excel_file = "Pre_Arcsinh_Median_FI.xlsx",
  positive_mfi_colname = "MFI POSITIVE POPULATION",
  negative_mfi_colname = c(extern = "MFI NEGATIVE POPULATION  UNSTAINED")
)
}
\arguments{
\item{excel_file}{Character. Path to the Excel file. The file must contain a very specific format
with at least the following columns:
\itemize{
\item \code{EXP}
\item \code{CD3 LOT}
\item \code{MACHINE}
\item \code{CHANNEL}
\item \code{DYE}
\item \code{Name of the data file containing the data set}
\item \code{MFI FSC}
\item \code{MFI SSC}
\item \code{MFI POSITIVE POPULATION}
\item \code{MFI NEGATIVE POPULATION (GG)}
\item \code{MFI NEGATIVE POPULATION  UNSTAINED}
}
Each sample should be separated by exactly one blank row.
Named sheets such as "MFI NAVIOS" or "MFI EX" are assumed.}

\item{positive_mfi_colname}{Character. Column name in the Excel file for the positive MFI values.
Default is \code{"MFI POSITIVE POPULATION"}.}

\item{negative_mfi_colname}{Named character vector. Column name(s) in the Excel file for the negative MFI values.
The names are used as the output list names (e.g. "extern", "intern").
Default is \code{c("extern" = "MFI NEGATIVE POPULATION  UNSTAINED")}.}
}
\value{
A named list (e.g. "intern", "extern") of per-sample MFI matrices. Each element of the list is itself a
list where each entry is a matrix with:
\describe{
\item{Rows}{Two rows: one for positive MFI and one for negative MFI.}
\item{Columns}{Channel-marker names (e.g. \code{"FL1 CD3 FITC"}, \code{"FL2 CD3 PE"}, etc.).}
}

If only one negative column is provided, the output is a single named list (not wrapped in another list).

List ("intern", "extern") of matrices with MFIs per sample, looking like
this:
$intern
$intern$Align_01.Lot_A.NAVIOS
FL1 CD3 FITC FL2 CD3 PE FL3 CD3 ECD FL4 CD3 PC5.5 FL5 CD3 PC7 FL6 CD3 APC FL7 CD3 AF700 FL8 CD3 AA750 FL9 CD3 PB FL10 CD3 KrO
MFI POSITIVE POPULATION          37488.82   131657.6   139639.11     790976.38    451150.3    54247.44      37088.07      24695.75   27504.88     10440.54
MFI NEGATIVE POPULATION (GG)       219.82      298.0      437.83        615.24       364.9       66.68        164.55         98.35     824.71       792.06
}
\description{
This function reads an Excel file containing MFIs for single-stained cytometry samples
and returns a list of MFI matrices, grouped by sample and machine. Each matrix contains
the positive and negative MFIs for each channel-marker combination.
}
\examples{
# See tests
}
\keyword{relativisation}
